import { endpoints } from "../constants/discord.ts";
import { RequestManager } from "./requestManager.ts";
import { spawnShards } from "./shardingManager.ts";
export let authorization = "";
export let botID = "";
export let eventHandlers = {};
export let botGatewayData;
export const identifyPayload = {
    token: "",
    compress: false,
    properties: {
        $os: "linux",
        $browser: "Discordeno",
        $device: "Discordeno",
    },
    intents: 0,
    shard: [0, 0],
};
export const createClient = async (data) => {
    if (data.eventHandlers)
        eventHandlers = data.eventHandlers;
    authorization = `Bot ${data.token}`;
    botGatewayData = await RequestManager.get(endpoints.GATEWAY_BOT);
    identifyPayload.token = data.token;
    identifyPayload.intents = data.intents.reduce((bits, next) => (bits |= next), 0);
    spawnShards(botGatewayData, identifyPayload);
};
export default createClient;
export function updateEventHandlers(newEventHandlers) {
    eventHandlers = newEventHandlers;
}
export function setBotID(id) {
    botID = id;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2xpZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiY2xpZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQUUsTUFBTSx5QkFBeUIsQ0FBQztBQUdwRCxPQUFPLEVBQUUsY0FBYyxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFDckQsT0FBTyxFQUFFLFdBQVcsRUFBRSxNQUFNLHNCQUFzQixDQUFDO0FBRW5ELE1BQU0sQ0FBQyxJQUFJLGFBQWEsR0FBRyxFQUFFLENBQUM7QUFDOUIsTUFBTSxDQUFDLElBQUksS0FBSyxHQUFHLEVBQUUsQ0FBQztBQUV0QixNQUFNLENBQUMsSUFBSSxhQUFhLEdBQWtCLEVBQUUsQ0FBQztBQUU3QyxNQUFNLENBQUMsSUFBSSxjQUFxQyxDQUFDO0FBRWpELE1BQU0sQ0FBQyxNQUFNLGVBQWUsR0FBRztJQUM3QixLQUFLLEVBQUUsRUFBRTtJQUNULFFBQVEsRUFBRSxLQUFLO0lBQ2YsVUFBVSxFQUFFO1FBQ1YsR0FBRyxFQUFFLE9BQU87UUFDWixRQUFRLEVBQUUsWUFBWTtRQUN0QixPQUFPLEVBQUUsWUFBWTtLQUN0QjtJQUNELE9BQU8sRUFBRSxDQUFDO0lBQ1YsS0FBSyxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQztDQUNkLENBQUM7QUFFRixNQUFNLENBQUMsTUFBTSxZQUFZLEdBQUcsS0FBSyxFQUFFLElBQW1CLEVBQUUsRUFBRTtJQUN4RCxJQUFJLElBQUksQ0FBQyxhQUFhO1FBQUUsYUFBYSxHQUFHLElBQUksQ0FBQyxhQUFhLENBQUM7SUFDM0QsYUFBYSxHQUFHLE9BQU8sSUFBSSxDQUFDLEtBQUssRUFBRSxDQUFDO0lBR3BDLGNBQWMsR0FBRyxNQUFNLGNBQWMsQ0FBQyxHQUFHLENBQ3ZDLFNBQVMsQ0FBQyxXQUFXLENBQ0csQ0FBQztJQUUzQixlQUFlLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUM7SUFDbkMsZUFBZSxDQUFDLE9BQU8sR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FDM0MsQ0FBQyxJQUFJLEVBQUUsSUFBSSxFQUFFLEVBQUUsQ0FBQyxDQUFDLElBQUksSUFBSSxJQUFJLENBQUMsRUFDOUIsQ0FBQyxDQUNGLENBQUM7SUFFRixXQUFXLENBQUMsY0FBYyxFQUFFLGVBQWUsQ0FBQyxDQUFDO0FBQy9DLENBQUMsQ0FBQztBQUVGLGVBQWUsWUFBWSxDQUFDO0FBRTVCLE1BQU0sVUFBVSxtQkFBbUIsQ0FBQyxnQkFBK0I7SUFDakUsYUFBYSxHQUFHLGdCQUFnQixDQUFDO0FBQ25DLENBQUM7QUFFRCxNQUFNLFVBQVUsUUFBUSxDQUFDLEVBQVU7SUFDakMsS0FBSyxHQUFHLEVBQUUsQ0FBQztBQUNiLENBQUMifQ==