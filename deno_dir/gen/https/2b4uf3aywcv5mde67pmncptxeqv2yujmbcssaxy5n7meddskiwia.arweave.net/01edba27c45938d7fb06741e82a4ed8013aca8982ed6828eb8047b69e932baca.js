import { eventHandlers } from "../module/client.ts";
import { structures } from "../structures/mod.ts";
import { cacheHandlers } from "./cache.ts";
export async function handleInternalGuildRoleCreate(data) {
    if (data.t !== "GUILD_ROLE_CREATE")
        return;
    const payload = data.d;
    const guild = await cacheHandlers.get("guilds", payload.guild_id);
    if (!guild)
        return;
    const role = await structures.createRole(payload.role);
    const roles = guild.roles.set(payload.role.id, role);
    guild.roles = roles;
    return eventHandlers.roleCreate?.(guild, role);
}
export async function handleInternalGuildRoleDelete(data) {
    if (data.t !== "GUILD_ROLE_DELETE")
        return;
    const payload = data.d;
    const guild = await cacheHandlers.get("guilds", payload.guild_id);
    if (!guild)
        return;
    const cachedRole = guild.roles.get(payload.role_id);
    guild.roles.delete(payload.role_id);
    eventHandlers.roleDelete?.(guild, cachedRole);
}
export async function handleInternalGuildRoleUpdate(data) {
    if (data.t !== "GUILD_ROLE_UPDATE")
        return;
    const payload = data.d;
    const guild = await cacheHandlers.get("guilds", payload.guild_id);
    if (!guild)
        return;
    const cachedRole = guild.roles.get(payload.role.id);
    if (!cachedRole)
        return;
    const role = await structures.createRole(payload.role);
    eventHandlers.roleUpdate?.(guild, role, cachedRole);
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicm9sZXMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJyb2xlcy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFNQSxPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFDcEQsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLHNCQUFzQixDQUFDO0FBQ2xELE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSxZQUFZLENBQUM7QUFFM0MsTUFBTSxDQUFDLEtBQUssVUFBVSw2QkFBNkIsQ0FBQyxJQUFvQjtJQUN0RSxJQUFJLElBQUksQ0FBQyxDQUFDLEtBQUssbUJBQW1CO1FBQUUsT0FBTztJQUUzQyxNQUFNLE9BQU8sR0FBRyxJQUFJLENBQUMsQ0FBcUIsQ0FBQztJQUMzQyxNQUFNLEtBQUssR0FBRyxNQUFNLGFBQWEsQ0FBQyxHQUFHLENBQUMsUUFBUSxFQUFFLE9BQU8sQ0FBQyxRQUFRLENBQUMsQ0FBQztJQUNsRSxJQUFJLENBQUMsS0FBSztRQUFFLE9BQU87SUFFbkIsTUFBTSxJQUFJLEdBQUcsTUFBTSxVQUFVLENBQUMsVUFBVSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUN2RCxNQUFNLEtBQUssR0FBRyxLQUFLLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLEVBQUUsRUFBRSxJQUFJLENBQUMsQ0FBQztJQUNyRCxLQUFLLENBQUMsS0FBSyxHQUFHLEtBQUssQ0FBQztJQUNwQixPQUFPLGFBQWEsQ0FBQyxVQUFVLEVBQUUsQ0FBQyxLQUFLLEVBQUUsSUFBSSxDQUFDLENBQUM7QUFDakQsQ0FBQztBQUVELE1BQU0sQ0FBQyxLQUFLLFVBQVUsNkJBQTZCLENBQUMsSUFBb0I7SUFDdEUsSUFBSSxJQUFJLENBQUMsQ0FBQyxLQUFLLG1CQUFtQjtRQUFFLE9BQU87SUFFM0MsTUFBTSxPQUFPLEdBQUcsSUFBSSxDQUFDLENBQTJCLENBQUM7SUFDakQsTUFBTSxLQUFLLEdBQUcsTUFBTSxhQUFhLENBQUMsR0FBRyxDQUFDLFFBQVEsRUFBRSxPQUFPLENBQUMsUUFBUSxDQUFDLENBQUM7SUFDbEUsSUFBSSxDQUFDLEtBQUs7UUFBRSxPQUFPO0lBRW5CLE1BQU0sVUFBVSxHQUFHLEtBQUssQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUUsQ0FBQztJQUNyRCxLQUFLLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLENBQUM7SUFDcEMsYUFBYSxDQUFDLFVBQVUsRUFBRSxDQUFDLEtBQUssRUFBRSxVQUFVLENBQUMsQ0FBQztBQUNoRCxDQUFDO0FBRUQsTUFBTSxDQUFDLEtBQUssVUFBVSw2QkFBNkIsQ0FBQyxJQUFvQjtJQUN0RSxJQUFJLElBQUksQ0FBQyxDQUFDLEtBQUssbUJBQW1CO1FBQUUsT0FBTztJQUUzQyxNQUFNLE9BQU8sR0FBRyxJQUFJLENBQUMsQ0FBcUIsQ0FBQztJQUMzQyxNQUFNLEtBQUssR0FBRyxNQUFNLGFBQWEsQ0FBQyxHQUFHLENBQUMsUUFBUSxFQUFFLE9BQU8sQ0FBQyxRQUFRLENBQUMsQ0FBQztJQUNsRSxJQUFJLENBQUMsS0FBSztRQUFFLE9BQU87SUFFbkIsTUFBTSxVQUFVLEdBQUcsS0FBSyxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQztJQUNwRCxJQUFJLENBQUMsVUFBVTtRQUFFLE9BQU87SUFFeEIsTUFBTSxJQUFJLEdBQUcsTUFBTSxVQUFVLENBQUMsVUFBVSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUN2RCxhQUFhLENBQUMsVUFBVSxFQUFFLENBQUMsS0FBSyxFQUFFLElBQUksRUFBRSxVQUFVLENBQUMsQ0FBQztBQUN0RCxDQUFDIn0=